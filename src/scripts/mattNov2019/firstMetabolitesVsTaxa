
rm(list=ls())

setwd("C:\\MattNov14");
library("Kendall")

myT <- read.delim("genuswMetadata.tsv", header=TRUE, comment.char="@", stringsAsFactors=FALSE,check.name=FALSE)
myT <- myT[!is.na(myT[,2]),]

taxaRange <- 2:which(names(myT)=="SampleSum")

metaboliteLow <- which(names(myT)=="Liver DHMA (ug/G)")
metaboliteHigh <- ncol(myT)
metaboliteRange <- c(  which(names(myT)=="Corticosterone Values (pg/ml)"), metaboliteLow:metaboliteHigh )

pValues <- vector()

index <-1 
for( i in taxaRange )
{
	if( sum(myT[,i] ==0 ) <= nrow(myT) /4 ) 
	{
		for( j in metaboliteRange )
		{
			allTaxa <- as.numeric(myT[,j])
		
			toInclude<- !is.na(allTaxa)
			
			taxaData <- myT[toInclude,i]
			metaboliteData <- allTaxa[toInclude]
			pValues[index] <- Kendall(taxaData ,metaboliteData )$sl
			index <- index + 1
		}		
	}
	
}